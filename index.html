<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chaos‑Kugel – erweiterte Kontrolle</title>
  <link rel="stylesheet" href="./src/styles.css" />
</head>
<body>
<div id="panel" class="is-hidden" aria-hidden="true">
  <div class="sheet-handle">
    <button id="sheetHandle" type="button" aria-expanded="false" aria-controls="panel">
      <span class="sheet-handle-bar" aria-hidden="true"></span>
      <span class="sheet-handle-label">Panel vergrößern</span>
    </button>
  </div>
  <header class="panel-header">
    <div class="panel-header__title">
      <h1 class="panel-header__heading">Steuerzentrale</h1>
      <p class="panel-header__subtitle">Passe Audio, Presets und Parameter im kompakten Layout an.</p>
    </div>
    <button id="panelClose" type="button" class="panel-header__close" data-no-swipe aria-label="Panel schließen" aria-controls="panel">
      <span aria-hidden="true">✕</span>
    </button>
  </header>
  <nav class="control-panel-tabs" aria-label="Panel-Navigation">
    <button
      type="button"
      class="control-panel-tab"
      data-panel-tab="media"
      aria-controls="audioPanel"
      aria-pressed="false"
    >
      <span class="control-panel-tab__icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" focusable="false" role="img">
          <path d="M4 7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3zm3-1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h10a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zm3 2.5a1 1 0 0 1 1.514-.857l5 3.5a1 1 0 0 1 0 1.714l-5 3.5A1 1 0 0 1 9 15.5z" />
        </svg>
      </span>
      <span class="control-panel-tab__label">Media</span>
    </button>
    <button
      type="button"
      class="control-panel-tab is-active"
      data-panel-tab="presets"
      aria-controls="visualPresetsPanel"
      aria-pressed="true"
    >
      <span class="control-panel-tab__icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" focusable="false" role="img">
          <path d="M5.5 4h13a1.5 1.5 0 0 1 1.34 2.162L16.5 13l2.64 5.838A1.5 1.5 0 0 1 17.74 21h-13a1.5 1.5 0 0 1-1.34-2.162L5.5 13 2.86 6.838A1.5 1.5 0 0 1 5.5 4zm1.22 2 2.28 5h6l2.28-5z" />
        </svg>
      </span>
      <span class="control-panel-tab__label">Presets</span>
    </button>
    <button
      type="button"
      class="control-panel-tab"
      data-panel-tab="config"
      aria-controls="configPanel"
      aria-pressed="false"
    >
      <span class="control-panel-tab__icon" aria-hidden="true">
        <svg viewBox="0 0 24 24" focusable="false" role="img">
          <path d="M10.325 4.317a1.75 1.75 0 0 1 3.35 0l.254.878a1.75 1.75 0 0 0 1.789 1.243l.904-.05a1.75 1.75 0 0 1 1.667 2.507l-.407.825a1.75 1.75 0 0 0 .405 1.995l.66.66a1.75 1.75 0 0 1-1.237 2.988h-.93a1.75 1.75 0 0 0-1.71 1.27l-.24.86a1.75 1.75 0 0 1-3.374.02l-.24-.88a1.75 1.75 0 0 0-1.71-1.27h-.93a1.75 1.75 0 0 1-1.237-2.988l.66-.66a1.75 1.75 0 0 0 .405-1.995l-.407-.825a1.75 1.75 0 0 1 1.667-2.507l.904.05a1.75 1.75 0 0 0 1.79-1.243zm1.675 6.683a2 2 0 1 0 0 4 2 2 0 0 0 0-4z" />
        </svg>
      </span>
      <span class="control-panel-tab__label">Config</span>
    </button>
  </nav>
  <section class="control-panel control-panel--presets" id="visualPresetsPanel" data-panel="presets" aria-labelledby="visualPresetsHeading">
    <header class="control-panel__header">
      <div class="control-panel__title">
        <div class="heading-with-info" data-info-size="medium">
          <h2 id="visualPresetsHeading">Visual Presets</h2>
          <button
            type="button"
            class="info-trigger"
            data-info-target="infoVisualPresets"
            aria-label="Hinweis zu Visual Presets anzeigen"
            aria-expanded="false"
            aria-controls="infoVisualPresets"
          >
            <span aria-hidden="true">?</span>
          </button>
          <div class="info-popover" id="infoVisualPresets" role="dialog" hidden>
            <p class="control-panel__subtitle">Kuratiere Presets, speichere Favoriten und stelle Zufallssets zusammen.</p>
          </div>
        </div>
      </div>
    </header>
    <div class="control-panel__body">
      <section class="panel-card panel-card--studio" id="patternStudio" aria-labelledby="patternStudioTitle">
        <header class="panel-card__header">
          <div class="heading-with-info" data-info-size="wide">
            <h3 id="patternStudioTitle">Pattern-Studio</h3>
            <button
              type="button"
              class="info-trigger"
              data-info-target="infoPatternStudio"
              aria-label="Hinweis zum Pattern-Studio anzeigen"
              aria-expanded="false"
              aria-controls="infoPatternStudio"
            >
              <span aria-hidden="true">?</span>
            </button>
            <div class="info-popover" id="infoPatternStudio" role="dialog" hidden>
              <p class="panel-card__subtitle">Starte mit kuratierten Presets oder forme deine eigene Ordnung aus dem Chaos.</p>
            </div>
          </div>
          <button type="button" class="panel-card__action" id="patternFocus" aria-label="Kamera auf Mittelpunkt ausrichten">📌 Fokus</button>
        </header>
        <div class="pattern-quick" id="patternPresetList" role="list" aria-label="Empfohlene Muster"></div>
        <div class="pattern-active">
          <div class="pattern-active__header heading-with-info" data-info-size="compact">
            <span class="pattern-active__label" id="patternActiveName">Aktives Muster: Freestyle</span>
            <button
              type="button"
              class="info-trigger"
              data-info-target="infoPatternActive"
              aria-label="Beschreibung zum aktiven Muster anzeigen"
              aria-expanded="false"
              aria-controls="infoPatternActive"
            >
              <span aria-hidden="true">?</span>
            </button>
            <div class="info-popover" id="infoPatternActive" role="dialog" hidden>
              <p class="pattern-active__description" id="patternActiveDescription">Nutze Presets oder die Regler unten, um dein persönliches Sternenfeld zu gestalten.</p>
            </div>
          </div>
        </div>
        <div class="pattern-formations">
          <div class="pattern-formations__head heading-with-info" data-info-size="compact" data-info-align="start">
            <h4 id="patternFormationTitle">Formationen</h4>
            <button
              type="button"
              class="info-trigger"
              data-info-target="infoPatternFormations"
              aria-label="Hinweis zu Formationen anzeigen"
              aria-expanded="false"
              aria-controls="infoPatternFormations"
            >
              <span aria-hidden="true">?</span>
            </button>
            <div class="info-popover" id="infoPatternFormations" role="dialog" hidden>
              <p class="pattern-formations__hint">Wechsle schnell zwischen geometrischen Anordnungen. STL-Importe erscheinen hier automatisch.</p>
            </div>
          </div>
          <div class="chip-group" id="patternDistributionChips" role="group" aria-labelledby="patternFormationTitle"></div>
        </div>
        <div class="pattern-actions">
          <button type="button" id="patternRandomPreset">✨ Zufall</button>
          <button type="button" id="patternRandomParameters">🎲 Chaos</button>
        </div>
      </section>
      <section class="panel-card panel-card--studio" id="presetStudio" aria-labelledby="presetStudioTitle">
        <header class="panel-card__header">
          <div class="heading-with-info" data-info-size="wide">
            <h3 id="presetStudioTitle">Preset-Studio</h3>
            <button
              type="button"
              class="info-trigger"
              data-info-target="infoPresetStudio"
              aria-label="Hinweis zum Preset-Studio anzeigen"
              aria-expanded="false"
              aria-controls="infoPresetStudio"
            >
              <span aria-hidden="true">?</span>
            </button>
            <div class="info-popover" id="infoPresetStudio" role="dialog" hidden>
              <p class="panel-card__subtitle">Kopiere deine aktuelle Szene, kehre zum Ausgangspunkt zurück oder starte einen Mix.</p>
              <p class="preset-studio__note">Nutze das Config-Panel, um eigene Presets zu speichern und sie anschließend hier oder in der Galerie auszuwählen.</p>
            </div>
          </div>
        </header>
        <div class="preset-studio__actions">
          <button type="button" id="presetStudioShuffle">🎲 Shuffle</button>
          <button type="button" id="presetStudioRestore">↩️ Reset</button>
          <button type="button" id="presetStudioCopy">📋 Kopieren</button>
        </div>
        <div class="preset-studio__status" id="presetStudioStatus" data-state="info" role="status" aria-live="polite">
          Tipp: Kopiere dein aktuelles Preset, um es zu teilen oder später erneut zu laden.
        </div>
      </section>
      <section class="panel-card panel-card--presets" aria-labelledby="userPresetTitle">
        <header class="panel-card__header">
          <div class="heading-with-info" data-info-size="wide">
            <h3 id="userPresetTitle">Gespeicherte Presets</h3>
            <button
              type="button"
              class="info-trigger"
              data-info-target="infoUserPresets"
              aria-label="Hinweis zu gespeicherten Presets anzeigen"
              aria-expanded="false"
              aria-controls="infoUserPresets"
            >
              <span aria-hidden="true">?</span>
            </button>
            <div class="info-popover" id="infoUserPresets" role="dialog" hidden>
              <p class="panel-card__subtitle">Wähle mehrere Presets für die Galerie oder starte die zufällige Wiedergabe.</p>
            </div>
          </div>
          <div class="panel-card__action-group">
            <div class="view-toggle" role="group" aria-label="Ansicht wählen">
              <button type="button" class="view-toggle__btn is-active" data-gallery-mode="grid" aria-pressed="true">
                <span aria-hidden="true">▦</span>
                <span class="view-toggle__label">Grid</span>
              </button>
              <button type="button" class="view-toggle__btn" data-gallery-mode="list" aria-pressed="false">
                <span aria-hidden="true">≣</span>
                <span class="view-toggle__label">Liste</span>
              </button>
            </div>
            <button type="button" class="panel-card__action" id="presetRandomPlayback" aria-pressed="false" disabled>🎲 Shuffle</button>
          </div>
        </header>
        <div class="preset-gallery" id="userPresetGallery" role="list" aria-label="Eigene Presets"></div>
        <p class="preset-gallery__empty" id="userPresetEmpty">Noch keine Presets gespeichert. Erstelle im Config-Panel deine ersten Favoriten.</p>
      </section>
    </div>
  </section>
  <section class="control-panel control-panel--config is-collapsed" id="configPanel" data-panel="config" aria-labelledby="configPanelHeading" aria-hidden="true">
    <header class="control-panel__header">
      <div class="control-panel__title">
        <h2 id="configPanelHeading">Config</h2>
        <p class="control-panel__subtitle">Speichere deine Einstellungen als Preset oder passe jeden Parameter fein an.</p>
      </div>
    </header>
    <div class="control-panel__body">
      <section class="panel-card panel-card--config" aria-labelledby="presetCreateTitle">
        <header class="panel-card__header">
          <div>
            <h3 id="presetCreateTitle">Visuelles Preset speichern</h3>
            <p class="panel-card__subtitle">Nutze den aktuellen Stand als neues Preset inklusive Vorschaubild.</p>
          </div>
        </header>
        <form class="preset-form" id="presetCreateForm">
          <div class="preset-form__row">
            <label for="presetName">Name</label>
            <input id="presetName" name="presetName" type="text" maxlength="60" placeholder="z. B. Polar Glow" required />
          </div>
          <div class="preset-form__row">
            <label for="presetNotes">Notizen</label>
            <textarea id="presetNotes" name="presetNotes" rows="2" maxlength="160" placeholder="Stimmung, Nutzung, Besonderheiten"></textarea>
          </div>
          <div class="preset-form__actions">
            <button type="submit" id="presetSaveButton">💾 Speichern</button>
          </div>
        </form>
        <p class="preset-form__hint" id="presetFormHint">Deine Presets werden lokal gespeichert und stehen in der Galerie bereit.</p>
      </section>
      <h3>Parameter</h3>
  <section class="accordion" id="acc-points">
    <button type="button" class="accordion__trigger" id="acc-points-trigger" aria-expanded="true" aria-controls="acc-points-panel">
      Punkte
    </button>
    <div class="accordion__panel" id="acc-points-panel" role="region" aria-labelledby="acc-points-trigger">
      <div class="row">
        <label for="pCount">Anzahl Punkte (Summe)</label>
        <div class="wrap">
          <input id="pCount" type="number" min="0" step="1" readonly />
          <div class="val" id="vCount"></div>
        </div>
      </div>
      <div class="row">
        <label for="pRadius">Radius</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pRadius" data-bound="min" />
          <input id="pRadius" type="range" min="40" max="260" step="1" />
          <input class="bound-input" type="number" data-target="pRadius" data-bound="max" />
          <div class="val" id="vRadius"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSizeVar">Größenvariation (Δ)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSizeVar" data-bound="min" />
          <input id="pSizeVar" type="range" min="0" max="10" step="0.1" />
          <input class="bound-input" type="number" data-target="pSizeVar" data-bound="max" />
          <div class="val" id="vSizeVar"></div>
        </div>
      </div>
      <div class="row">
        <label for="pCluster">Clustering</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pCluster" data-bound="min" />
          <input id="pCluster" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pCluster" data-bound="max" />
          <div class="val" id="vCluster"></div>
        </div>
      </div>
      <div class="row">
        <label for="pPointAlpha">Deckkraft Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pPointAlpha" data-bound="min" />
          <input id="pPointAlpha" type="range" min="0.3" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pPointAlpha" data-bound="max" />
          <div class="val" id="vPointAlpha"></div>
        </div>
      </div>
      <div class="row">
        <label for="pHue">Punktfarbe (Farbton)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pHue" data-bound="min" />
          <input id="pHue" type="range" min="0" max="360" step="1" />
          <input class="bound-input" type="number" data-target="pHue" data-bound="max" />
          <div class="val" id="vHue"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSaturation">Punktfarbe (Sättigung)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSaturation" data-bound="min" />
          <input id="pSaturation" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pSaturation" data-bound="max" />
          <div class="val" id="vSaturation"></div>
        </div>
      </div>
      <div class="row">
        <label for="pValue">Punktfarbe (Helligkeit)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pValue" data-bound="min" />
          <input id="pValue" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pValue" data-bound="max" />
          <div class="val" id="vValue"></div>
        </div>
      </div>
      <div class="row">
        <label for="pHueColor">Farben für einzelne Punkte</label>
        <div class="swatch-grid" id="pColorSwatches">
          <button type="button" class="color-swatch" data-color-swatch data-h="210" data-s="0.75" data-v="1" aria-pressed="false" style="--swatch:#5fa8ff;">
            Polarblau
          </button>
          <button type="button" class="color-swatch" data-color-swatch data-h="280" data-s="0.55" data-v="1" aria-pressed="false" style="--swatch:#ba68ff;">
            Kosmos
          </button>
          <button type="button" class="color-swatch" data-color-swatch data-h="35" data-s="0.82" data-v="1" aria-pressed="false" style="--swatch:#ffad46; --swatch-text:#1a1320;">
            Sonnenaufg.
          </button>
          <button type="button" class="color-swatch" data-color-swatch data-h="150" data-s="0.9" data-v="0.9" aria-pressed="false" style="--swatch:#36f5a3; --swatch-text:#10251c;">
            Neonwald
          </button>
          <button type="button" class="color-swatch" data-color-swatch data-h="8" data-s="0.88" data-v="1" aria-pressed="false" style="--swatch:#ff5a4e;">
            Plasma
          </button>
          <button type="button" class="color-swatch" data-color-swatch data-h="0" data-s="0" data-v="0.94" aria-pressed="false" style="--swatch:#f0f0f0; --swatch-text:#111;">
            Neutral
          </button>
          <label class="color-swatch color-swatch--picker" for="pHueColor">
            <span class="color-swatch__label">Eigene Farbe</span>
            <input id="pHueColor" type="color" aria-label="Eigene Punktfarbe wählen" />
          </label>
        </div>
        <p class="hint">Tipp: Wähle oben einen Farbton oder nutze den Zufallsmodus bzw. erhöhe die Farbton-Streuung, damit alle Punkte eigene Farben annehmen.</p>
      </div>
      <div class="row">
        <label for="pColorMode">Farbmodus</label>
        <select id="pColorMode">
          <option value="uniform">Einzelfarbe</option>
          <option value="radialPulse">Radialer Puls</option>
          <option value="axisWave">Vertikale Welle</option>
          <option value="phaseFlicker">Zufälliges Flimmern</option>
          <option value="randomHue">Zufallsmodus</option>
        </select>
      </div>
      <div class="row">
        <label for="pColorIntensity">Farbintensität</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pColorIntensity" data-bound="min" />
          <input id="pColorIntensity" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pColorIntensity" data-bound="max" />
          <div class="val" id="vColorIntensity"></div>
        </div>
      </div>
      <div class="row">
        <label for="pColorSpeed">Farbanimation (Tempo)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pColorSpeed" data-bound="min" />
          <input id="pColorSpeed" type="range" min="0" max="5" step="0.05" />
          <input class="bound-input" type="number" data-target="pColorSpeed" data-bound="max" />
          <div class="val" id="vColorSpeed"></div>
        </div>
      </div>
      <div class="row">
        <label for="pHueSpread">Farbton-Streuung</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pHueSpread" data-bound="min" />
          <input id="pHueSpread" type="range" min="0" max="180" step="1" />
          <input class="bound-input" type="number" data-target="pHueSpread" data-bound="max" />
          <div class="val" id="vHueSpread"></div>
        </div>
      </div>
      <div class="row">
        <label for="pColorPropagationDistance">Farb-Ausbreitung (Distanz)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pColorPropagationDistance" data-bound="min" />
          <input id="pColorPropagationDistance" type="range" min="10" max="600" step="1" />
          <input class="bound-input" type="number" data-target="pColorPropagationDistance" data-bound="max" />
          <div class="val" id="vColorPropagationDistance"></div>
        </div>
      </div>
      <div class="row">
        <label for="pColorPropagationDuration">Farb-Ausbreitung (Dauer)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pColorPropagationDuration" data-bound="min" />
          <input id="pColorPropagationDuration" type="range" min="0" max="20" step="0.1" />
          <input class="bound-input" type="number" data-target="pColorPropagationDuration" data-bound="max" />
          <div class="val" id="vColorPropagationDuration"></div>
        </div>
      </div>
      <div class="row">
        <label for="pColorToneCount">Farbtöne (Anzahl)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pColorToneCount" data-bound="min" />
          <input id="pColorToneCount" type="range" min="1" max="12" step="1" />
          <input class="bound-input" type="number" data-target="pColorToneCount" data-bound="max" />
          <div class="val" id="vColorToneCount"></div>
        </div>
      </div>
      <div class="row">
        </select>
      </div>
      <div class="row">
        <label for="pSeedStars">Seed Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSeedStars" data-bound="min" />
          <input id="pSeedStars" type="range" min="1" max="9999" step="1" />
          <input class="bound-input" type="number" data-target="pSeedStars" data-bound="max" />
          <div class="val" id="vSeedStars"></div>
        </div>
      </div>
      <div class="row">
        <label>Punktkategorien (Anzahl)</label>
        <div class="stack">
          <div class="wrap">
            <span class="tag">Klein</span>
            <input id="pCatSmallCount" type="number" min="0" step="1" />
            <div class="val" id="vCatSmallCount"></div>
          </div>
          <div class="wrap">
            <span class="tag">Mittel</span>
            <input id="pCatMediumCount" type="number" min="0" step="1" />
            <div class="val" id="vCatMediumCount"></div>
          </div>
          <div class="wrap">
            <span class="tag">Groß</span>
            <input id="pCatLargeCount" type="number" min="0" step="1" />
            <div class="val" id="vCatLargeCount"></div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <section class="accordion" id="acc-distribution">
    <button type="button" class="accordion__trigger" id="acc-distribution-trigger" aria-expanded="false" aria-controls="acc-distribution-panel">
      Verteilung & Volumen
    </button>
    <div class="accordion__panel" id="acc-distribution-panel" role="region" aria-labelledby="acc-distribution-trigger" hidden>
      <div class="row">
        <label for="pDistribution">Verteilungsalgorithmus</label>
        <select id="pDistribution">
          <option value="random">Zufall (Sphäre)</option>
          <option value="fibonacci">Fibonacci-Sphäre</option>
          <option value="spiral">Galaxie-Spirale</option>
          <option value="cube">Würfel-Volumen</option>
          <option value="cylinder">Zylinder-Volumen</option>
          <option value="octahedron">Oktaeder-Volumen</option>
          <option value="stl" data-stl-option hidden disabled>Importierte STL-Punkte</option>
        </select>
      </div>
      <div class="row file-row">
        <label for="stlFiles">STL-Modelle</label>
        <input id="stlFiles" type="file" accept=".stl,model/stl,application/sla" multiple />
        <div class="file-meta" id="stlFileMeta">Keine Auswahl</div>
        <div class="hint">Nach dem Import kannst du wählen, ob die STL-Punkte zusätzlich oder als Verteilungsalgorithmus genutzt werden.</div>
      </div>
      <div class="row">
        <div class="wrap">
          <button type="button" id="stlClear" disabled>🧹 Modelle entfernen</button>
        </div>
      </div>
    </div>
  </section>
  <section class="accordion" id="acc-size">
    <button type="button" class="accordion__trigger" id="acc-size-trigger" aria-expanded="false" aria-controls="acc-size-panel">
      Größe
    </button>
    <div class="accordion__panel" id="acc-size-panel" role="region" aria-labelledby="acc-size-trigger" hidden>
      <div class="row">
        <label for="pSizeTiny">Größe winzige Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSizeTiny" data-bound="min" />
          <input id="pSizeTiny" type="range" min="0.05" max="3" step="0.01" />
          <input class="bound-input" type="number" data-target="pSizeTiny" data-bound="max" />
          <div class="val" id="vSizeTiny"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSizeSmall">Größe kleine Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSizeSmall" data-bound="min" />
          <input id="pSizeSmall" type="range" min="0.2" max="3" step="0.05" />
          <input class="bound-input" type="number" data-target="pSizeSmall" data-bound="max" />
          <div class="val" id="vSizeSmall"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSizeMedium">Größe mittlere Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSizeMedium" data-bound="min" />
          <input id="pSizeMedium" type="range" min="0.2" max="3" step="0.05" />
          <input class="bound-input" type="number" data-target="pSizeMedium" data-bound="max" />
          <div class="val" id="vSizeMedium"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSizeLarge">Größe große Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSizeLarge" data-bound="min" />
          <input id="pSizeLarge" type="range" min="0.2" max="3" step="0.05" />
          <input class="bound-input" type="number" data-target="pSizeLarge" data-bound="max" />
          <div class="val" id="vSizeLarge"></div>
        </div>
      </div>
    </div>
  </section>
  <section class="accordion" id="acc-connections">
    <button type="button" class="accordion__trigger" id="acc-connections-trigger" aria-expanded="false" aria-controls="acc-connections-panel">
      Verbindungen
    </button>
    <div class="accordion__panel" id="acc-connections-panel" role="region" aria-labelledby="acc-connections-trigger" hidden>
      <div class="row">
        <label for="pTinyCount">Menge winzige Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pTinyCount" data-bound="min" />
          <input id="pTinyCount" type="range" min="0" max="5000" step="10" />
          <input class="bound-input" type="number" data-target="pTinyCount" data-bound="max" />
          <div class="val" id="vTinyCount"></div>
        </div>
      </div>
      <div class="row">
        <label for="pConnPercent">Prozent Verbindungen</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pConnPercent" data-bound="min" />
          <input id="pConnPercent" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pConnPercent" data-bound="max" />
          <div class="val" id="vConnPercent"></div>
        </div>
      </div>
      <div class="row">
        <label for="pTinyAlpha">Deckkraft winzige Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pTinyAlpha" data-bound="min" />
          <input id="pTinyAlpha" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pTinyAlpha" data-bound="max" />
          <div class="val" id="vTinyAlpha"></div>
        </div>
      </div>
      <div class="row">
        <label for="pSeedTiny">Seed winzige Punkte</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pSeedTiny" data-bound="min" />
          <input id="pSeedTiny" type="range" min="1" max="9999" step="1" />
          <input class="bound-input" type="number" data-target="pSeedTiny" data-bound="max" />
          <div class="val" id="vSeedTiny"></div>
        </div>
      </div>
    </div>
  </section>
  <section class="accordion" id="acc-display">
    <button type="button" class="accordion__trigger" id="acc-display-trigger" aria-expanded="false" aria-controls="acc-display-panel">
      Darstellung
    </button>
    <div class="accordion__panel" id="acc-display-panel" role="region" aria-labelledby="acc-display-trigger" hidden>
      <div class="row">
        <label for="pEdgeSoft">Randweichheit</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pEdgeSoft" data-bound="min" />
          <input id="pEdgeSoft" type="range" min="0" max="1" step="0.01" />
          <input class="bound-input" type="number" data-target="pEdgeSoft" data-bound="max" />
          <div class="val" id="vEdgeSoft"></div>
        </div>
      </div>
      <div class="row">
        <label for="pBlending">Blending-Modus</label>
        <select id="pBlending">
          <option value="Normal">Normal</option>
          <option value="Additive">Additiv</option>
        </select>
      </div>
      <div class="row">
        <label><input id="pFilled" type="checkbox" /> Gefüllt (harte Kreise)</label>
      </div>
    </div>
  </section>
  <section class="accordion" id="acc-dynamics">
    <button type="button" class="accordion__trigger" id="acc-dynamics-trigger" aria-expanded="true" aria-controls="acc-dynamics-panel">
      Dynamik
    </button>
    <div class="accordion__panel" id="acc-dynamics-panel" role="region" aria-labelledby="acc-dynamics-trigger">
      <div class="row">
        <label for="pMotionMode">Bewegungsmodus</label>
        <select id="pMotionMode">
          <option value="static">Statisch</option>
          <option value="sine">Sinuswellen</option>
          <option value="noise">Noise</option>
          <option value="orbit">Orbit</option>
        </select>
      </div>
      <div class="row">
        <label for="pMotionSpeed">Bewegungsgeschwindigkeit</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pMotionSpeed" data-bound="min" />
          <input id="pMotionSpeed" type="range" min="0" max="3" step="0.01" />
          <input class="bound-input" type="number" data-target="pMotionSpeed" data-bound="max" />
          <div class="val" id="vMotionSpeed"></div>
        </div>
      </div>
      <div class="row">
        <label for="pMotionAmplitude">Amplitude</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pMotionAmplitude" data-bound="min" />
          <input id="pMotionAmplitude" type="range" min="0" max="40" step="0.1" />
          <input class="bound-input" type="number" data-target="pMotionAmplitude" data-bound="max" />
          <div class="val" id="vMotionAmplitude"></div>
        </div>
      </div>
      <div class="row">
        <label for="pMotionNoiseStrength">Noise-Intensität</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pMotionNoiseStrength" data-bound="min" />
          <input id="pMotionNoiseStrength" type="range" min="0" max="2.5" step="0.01" />
          <input class="bound-input" type="number" data-target="pMotionNoiseStrength" data-bound="max" />
          <div class="val" id="vMotionNoiseStrength"></div>
        </div>
      </div>
      <div class="row">
        <label for="pMotionNoiseScale">Noise-Skala</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="pMotionNoiseScale" data-bound="min" />
          <input id="pMotionNoiseScale" type="range" min="0.1" max="4" step="0.01" />
          <input class="bound-input" type="number" data-target="pMotionNoiseScale" data-bound="max" />
          <div class="val" id="vMotionNoiseScale"></div>
        </div>
      </div>
      <div class="row">
        <label>Rotation</label>
        <div class="wrap">
          <button id="autoSpin" aria-pressed="false">🌀 Auto-Rotation aus</button>
          <button id="spinStop" aria-disabled="true" disabled>⏹️ Stoppen</button>
        </div>
      </div>
      <div class="row">
        <label>Winkelgeschwindigkeit (rad/s)</label>
        <div class="stack">
          <div class="wrap">
            <span class="tag">X</span>
            <input class="bound-input" type="number" data-target="spinVelX" data-bound="min" />
            <input id="spinVelX" type="range" min="-3" max="3" step="0.01" />
            <input class="bound-input" type="number" data-target="spinVelX" data-bound="max" />
            <div class="val" id="vSpinX"></div>
          </div>
          <div class="wrap">
            <span class="tag">Y</span>
            <input class="bound-input" type="number" data-target="spinVelY" data-bound="min" />
            <input id="spinVelY" type="range" min="-3" max="3" step="0.01" />
            <input class="bound-input" type="number" data-target="spinVelY" data-bound="max" />
            <div class="val" id="vSpinY"></div>
          </div>
          <div class="wrap">
            <span class="tag">Z</span>
            <input class="bound-input" type="number" data-target="spinVelZ" data-bound="min" />
            <input id="spinVelZ" type="range" min="-3" max="3" step="0.01" />
            <input class="bound-input" type="number" data-target="spinVelZ" data-bound="max" />
            <div class="val" id="vSpinZ"></div>
          </div>
        </div>
      </div>
      <div class="row">
        <label for="spinSpeed">Geschwindigkeitsfaktor</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="spinSpeed" data-bound="min" />
          <input id="spinSpeed" type="range" min="0" max="20" step="0.01" />
          <input class="bound-input" type="number" data-target="spinSpeed" data-bound="max" />
          <div class="val" id="vSpinSpeed"></div>
        </div>
      </div>
      <div class="row">
        <label>Trägheit</label>
        <div class="wrap">
          <button id="spinInertia" aria-pressed="true">🪁 Trägheit an</button>
          <div class="val" id="vInertia"></div>
        </div>
      </div>
      <div class="row">
        <label for="spinDecay">Abklingzeit (s)</label>
        <div class="wrap">
          <input class="bound-input" type="number" data-target="spinDecay" data-bound="min" />
          <input id="spinDecay" type="range" min="1" max="30" step="1" />
          <input class="bound-input" type="number" data-target="spinDecay" data-bound="max" />
          <div class="val" id="vSpinDecay"></div>
        </div>
      </div>
    </div>
  </section>
    </div>
  </section>
  <section class="control-panel control-panel--media is-collapsed" id="audioPanel" data-panel="media" role="complementary" aria-label="Audio-Steuerung" aria-hidden="true">
    <header class="control-panel__header">
      <div class="control-panel__title">
        <h2 id="mediaPanelHeading">Media Player</h2>
        <p class="control-panel__subtitle">Steuere Wiedergabe, Mikrofon und Audio-Reaktivität.</p>
      </div>
    </header>
    <div class="control-panel__body" id="audioPanelBody">
    <section class="audio-section audio-section--player" aria-labelledby="audioPlaylistTitle">
      <header class="audio-player-head">
        <div class="audio-player-head__meta">
          <span class="audio-player-head__label">Jetzt läuft</span>
          <h4 class="audio-player-head__title" id="audioCurrentTitle">Keine Auswahl</h4>
          <p class="audio-player-head__description" id="audioCurrentDetails">Lade eigene Songs oder nutze die Preset-Playlist.</p>
        </div>
        <div class="audio-player-head__status" role="status" aria-live="polite">
          <span class="status-indicator" id="audioStatusDot" data-state="idle" aria-hidden="true"></span>
          <span class="status-text" id="audioStatus" data-state="idle">Audio-Reaktivität inaktiv</span>
        </div>
      </header>
      <div class="audio-player-controls">
        <div class="audio-controls audio-controls--primary">
          <button type="button" id="audioPrev" disabled aria-label="Vorheriger Titel">⏮️ Zurück</button>
          <button type="button" id="audioPlay" disabled aria-label="Titel abspielen">▶️ Play</button>
          <button type="button" id="audioStop" disabled aria-label="Wiedergabe stoppen">⏹️ Stop</button>
          <button type="button" id="audioNext" disabled aria-label="Nächster Titel">⏭️ Weiter</button>
        </div>
        <div class="audio-controls audio-controls--secondary">
          <button type="button" id="audioRepeat" aria-pressed="false" disabled>🔁 Repeat aus</button>
        </div>
      </div>
      <div class="audio-player-upload">
        <label for="audioFile">Playlist erweitern</label>
        <input id="audioFile" type="file" accept="audio/*" multiple />
        <div class="audio-player-upload__meta">
          <div class="file-meta" id="audioFileMeta">Keine Auswahl</div>
        </div>
      </div>
      <div class="audio-playlist" aria-live="polite">
        <div class="audio-playlist__head">
          <h4 id="audioPlaylistTitle">Playlist</h4>
          <div class="playlist-meta" id="audioPlaylistMeta">Keine Playlist geladen</div>
        </div>
        <div class="audio-playlist__list" id="audioPlaylist" role="listbox" aria-label="Wiedergabeliste"></div>
        <p class="audio-playlist__empty" id="audioPlaylistEmpty">Keine Titel vorhanden. Lade deine Lieblingstracks oder nutze die Presets.</p>
      </div>
    </section>
    <section class="audio-section audio-section--reactivity">
      <div class="row">
        <label for="audioMicStart">Mikrofon</label>
        <div class="audio-controls">
          <button type="button" id="audioMicStart">🎙️ Start</button>
          <button type="button" id="audioMicStop" disabled>⏹️ Stop</button>
        </div>
      </div>
      <div class="row">
        <label>Audio-Reaktionsziele</label>
        <div class="modifier-grid" id="audioModifierGrid">
          <button type="button" class="modifier-toggle" data-modifier="motion" aria-pressed="true">Rotation</button>
          <button type="button" class="modifier-toggle" data-modifier="scale" aria-pressed="true">Skalierung</button>
          <button type="button" class="modifier-toggle" data-modifier="size" aria-pressed="true">Punktgröße</button>
          <button type="button" class="modifier-toggle" data-modifier="hue" aria-pressed="true">Farbton</button>
          <button type="button" class="modifier-toggle" data-modifier="saturation" aria-pressed="true">Sättigung</button>
          <button type="button" class="modifier-toggle" data-modifier="brightness" aria-pressed="true">Helligkeit</button>
          <button type="button" class="modifier-toggle" data-modifier="alpha" aria-pressed="true">Transparenz</button>
        </div>
      </div>
      <div class="row">
        <label>Reaktionsstärke</label>
        <div class="intensity-grid">
          <div class="wrap" data-intensity-row="motion">
            <span class="tag">Rotation</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="20" data-intensity-limit="motion" aria-label="Maximale Reaktionsstärke für Rotation in Prozent" />
            <input type="range" min="0" max="100" step="5" value="50" data-intensity-target="motion" />
            <div class="val" data-intensity-value="motion">50%</div>
          </div>
          <div class="wrap" data-intensity-row="scale">
            <span class="tag">Skalierung</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="scale" aria-label="Maximale Reaktionsstärke für Skalierung in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="scale" />
            <div class="val" data-intensity-value="scale">100%</div>
          </div>
          <div class="wrap" data-intensity-row="size">
            <span class="tag">Punktgröße</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="size" aria-label="Maximale Reaktionsstärke für Punktgröße in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="size" />
            <div class="val" data-intensity-value="size">100%</div>
          </div>
          <div class="wrap" data-intensity-row="hue">
            <span class="tag">Farbton</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="hue" aria-label="Maximale Reaktionsstärke für Farbton in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="hue" />
            <div class="val" data-intensity-value="hue">100%</div>
          </div>
          <div class="wrap" data-intensity-row="saturation">
            <span class="tag">Sättigung</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="saturation" aria-label="Maximale Reaktionsstärke für Sättigung in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="saturation" />
            <div class="val" data-intensity-value="saturation">100%</div>
          </div>
          <div class="wrap" data-intensity-row="brightness">
            <span class="tag">Helligkeit</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="brightness" aria-label="Maximale Reaktionsstärke für Helligkeit in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="brightness" />
            <div class="val" data-intensity-value="brightness">100%</div>
          </div>
          <div class="wrap" data-intensity-row="alpha">
            <span class="tag">Transparenz</span>
            <input class="intensity-limit" type="number" min="5" max="200" step="5" value="100" data-intensity-limit="alpha" aria-label="Maximale Reaktionsstärke für Transparenz in Prozent" />
            <input type="range" min="0" max="100" step="5" value="100" data-intensity-target="alpha" />
            <div class="val" data-intensity-value="alpha">100%</div>
          </div>
        </div>
      </div>
      <div class="row">
        <label for="brightnessAdaptationToggle">Helligkeitsadaption</label>
        <div class="wrap">
          <button type="button" id="brightnessAdaptationToggle" aria-pressed="true">🌗 Adaption an</button>
        </div>
      </div>
      <div class="row">
        <label for="audioRandomMode">Parameter-Zufall</label>
        <div class="audio-controls">
          <button type="button" id="audioRandomMode" aria-pressed="false">🔀 Komplett Random aus</button>
        </div>
      </div>
      <div class="panel-footnote" id="audioSupportNotice">Nutze eine Datei oder das Mikrofon, um die Punktfarben an Audio zu koppeln.</div>
    </section>
  </div>
  </section>
</div>
<div id="audioOverlay" data-visible="false" aria-hidden="true">
  <button type="button" id="audioOverlayButton" aria-label="Musik und Visualisierung starten">
    ▶️ Play – Musik & Visualisierung starten
  </button>
</div>
<script type="module" src="./src/main.js"></script>
</body>
</html>
